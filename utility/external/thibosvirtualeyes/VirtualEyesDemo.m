% VirtualEyesDemo - a demonstraton script%% Subroutines required: %   VirtualEyes.m (copyright by LN Thibos, Indiana University) %   mvnrnd.m (copyright by The Mathworks, Inc.)%% This Matlab program is an electronic appendix to the paper% "Retinal Image Quality for Virtual Eyes Generated by a Statistical Model% of Ocular Wavefront Aberrations" published in Ophthalmological and% Physiological Optics (2009).  Permission is granted to use this program% for scientific research purposes.  Commercial users should contact% Indiana University for licensing arrangements.%% © 2009 Larry Thibos, Indiana Universityn=100;  % number of eyespupil=6; % diameter of pupil (mm). Allowed values: 3, 4.5, 6, 7.5R = VirtualEyes(n,pupil); % matrix of 100 Zernike vectors, 36 coefficients%----- compute means & stdevsmodel_mean = mean(R)';                  % vector of mean coefficientsmodelS = cov(R);						% covariance matrixsd=sqrt(diag(modelS));					% vector of standard deviationsfigure;	% - show the vector of mean Z-coeffs with error barsmaxmodes=size(R,2);p = 2*sd; 	% 95% probability range errorbar(1:maxmodes-1,model_mean(2:maxmodes),p(2:maxmodes),'ko'); % omit pistonxlabel('Zernike mode'); ylabel('Coefficient value (microns)')title('Population mean and 95% probability range of Zernike coeffs')