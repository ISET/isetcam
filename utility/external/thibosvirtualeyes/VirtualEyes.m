function R = VirtualEyes(n,pupil)% VirtualEyes -  model Zernike vector as a multivariate Gaussian process%% input arguments:%	n = number of virtual eyes required%	pupil = pupil diameter (mm, allowed values are 3, 4.5, 6, 7.5)%% output arguments:%	R = matrix of Zernike coefficients. Each row is an eye, each col a mode.%% method: The vector of Zernike aberration coefficients describing the%   wavefront aberration function for any individual eye is modelled as a%   multivariate, Gaussian, random variable with known mean, variance and%   covariance.%% reference:  Thibos, L.N., Bradley, A., & Hong, X. (2002).%  "A statistical model of the aberration structure of normal,%  well-corrected eyes." Ophthalmic & Physiological Optics, 22(5), 427-433%%  Convention for specifying Zernike coefficients is described in:%    ANSI Z80.28 (2004). American National Standards Institute.  American%    national standard for ophthalmics - methods for reporting optical%    aberrations of eyes.%% This Matlab program is an electronic appendix to the paper% "Retinal Image Quality for Virtual Eyes Generated by a Statistical Model% of Ocular Wavefront Aberrations" published in Ophthalmological and% Physiological Optics (2009).  Permission is granted to use this program% for scientific research purposes.  Commercial users should contact% Indiana University for licensing arrangements.%% © 2002 Larry Thibos, Indiana Universityif pupil == 3    load IASstats30;elseif pupil == 4.5    load IASstats45;elseif pupil == 6.0    load IASstats60;elseif pupil == 7.5    load IASstats75;else error('Selected pupil diameter is not available')end% exercise the model using a multivariate normal random number generatorR = mvnrnd(sample_mean,S,n);  % each row of R is a vector of Zernike coeffs